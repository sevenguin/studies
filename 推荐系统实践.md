#推荐系统实践
* 社会化推荐：通过论坛等社交网络来询问，由人提供推荐
* 基于内容推荐：可以通过搜索引擎搜索自己喜欢的导演、演员（这个可以通过推荐系统自动化）
* 基于协同过滤：通过查看排行榜，看看别人喜欢什么，这个也可以通过推荐系统自动化，找到和自己历史兴趣想似的一批用户。

推荐系统的本质就是通过一定的办法将用户和物品联系起来（和广告有一种天生的关联属性）
应用范围：电子商务、电影、视频、音乐、社交网络、阅读、位置服务、个性化邮件和广告
推荐系统组成：前台页面、后台日志（用户数据）和推荐算法三部分
##推荐系统在各个领域的应用
###亚马逊
亚马逊使用基于内容（物品）的推荐算法，也有协同过滤的算法（根据Facebook的好友关系来推荐，推荐理由换成了喜欢过相关物品的用户头像）；还有一个相关推荐（购买这个物品的周边产品——打包销售，例如买手机推荐手机壳、充电器等）。亚马逊有20%~30%的收益来自于推荐系统（根据亚马逊前科学家说的，但是科学家有可能自抬身价）
###电影和视频网站
netfix，http://netfixprize.com 对推荐系统的比赛，__可以找找有没有论文之类的东西__。对外宣称给60%客户推荐电影和视频。参见：[netfix对外宣称](http://cdn-0.nflximg.com /us/pdf/Consumer_Press_Kit.pdf)

YouTube：个性推荐的点击率是热门视频点击率的两倍,[YouTube论文](http://dl.acm. org/citation. cfm?id=1864770)
###个性化音乐网络电台
推荐系统存在的两个必要条件：信息过载；客户无明确需求
Pandora：对歌曲的不同特性（旋律、节奏、编曲和歌词等）进行标注，这些标注称为音乐的基因，根据专家标注的基因计算歌曲的相似度，并给用户推荐和他之前喜欢的音乐在基因上想死的其他音乐。（这个算是基于内容）
Last.fm：根据所有用户的听歌记录以及用户对歌曲的反馈，在这一基础上计算出不同用户在歌曲上的喜好相似度（怎么界定两个歌曲相似？还是说两个人听的相同歌曲一样就是相似？）
###社交网络
利用用户的社交网络信息对用户进行个性化的物品推荐，信息流的会话推荐；给用户推荐好友
###个性化阅读
Google Reader；Zite；Digg
###基于位置
Foursquare：给用户推荐好友在附近的行为
在附近自己感兴趣的地方（吃饭、买东西——符合自己行为习惯和品性的）
###个性化邮件
Tapestry:通过分析用户阅读邮件的历史行为和习惯对新邮件进行重新排序，从而提高用户的工作效率
谷歌通过分析用户对邮件的历史行为，找到用欧冠胡感兴趣的邮件，展示在一个专门的收件箱里，用户每天可以浏览这个邮箱里的邮件，再浏览其他邮件。
`The Learning Behind Gmail Priority Inbo`
###个性化广告
上下文广告：通过分析用户正在浏览的网页内容，投放和网页内容相关的广告，代表系统是谷歌的Adsense
搜索广告：通过分析用户在当前用户中的搜索记录，判断用户的搜索目的，投放和用户的目的相关的广告
个性化展示广告：我们经常在很多网站看到大量展示的广告，他们是根据用户的兴趣对不同用户投放不同的展示广告。
###推荐系统评测
推荐系统三个参与方：用户、物品提供者和提供推荐系统的网站。
好的推荐系统不仅仅能够准确预测用户的行为，而且嫩能够扩展用户的视野，帮助用户返现那些他们可能会感兴趣，但却不那么容易发现的东西。
三种评测推荐效果的实验方法：离线实验、用户调查和在线实验
####离线实验
通过日志系统获得用户行为数据并按照一定格式生成一个标准的数据集
将数据集按照一定的规划分成训练集和测试集
在训练集上训练用户兴趣模型，在测试集上进行预测
通过事先定义的离线指标评测算法在测试集上的预测结果
离线实验的优缺点：

* 优点：1、不需要对实际系统的控制权；不需要用户参与实验；速度快，可以测试大量算法
* 缺点：无法计算商业上关心的指标；离线实验的指标和商业指标存在的差距

####用户调查
离线和实际的商业指标存在差距，比如预测准确率和用户满意度之间存在很大差别，高预测准确率不等于高用户满意度。
用户调查需要一些真实用户，让他们在需要测试的推荐系统上完成一些任务，在他们完成时，需要观察记录他们的行为，并让他们回答一些问题（单数具体完成哪些任务？回答哪些、哪类问题？），我们需要通过分析他们的行为和答案了解测试系统的性能。

* 优点：可以获得很多体现用户主管感受的指标，相对在线实验风险很低，出现错误很容易弥补
* 缺点：招募测试用户代价大，如果测试用户较少则失去了统计意义；而且测试环境下手机的测试指标可能在真实环境下无法重现（测试环境和真实环境下的行为可能存在不同）——离线在数据量等上面有较大差别，会对算法可能产生较大的影响

####在线实验
在完成离线实验和必要的用户调查后，可以将推荐系统上线做AB测试，将它和旧的算法进行比较。
AB测试：通过一定规则将用户随机分成几组，并对不同组的用户采用不同的算法，然后通过统计不同组用户的各种不同评测指标比较不同算法，比如可以统计不同组用户的点击率，通过点击率比较不同算法的性能。[abtests](http://www.abtests.com)
由于一个推荐系统涉及到算法和前段展示等，所以在进行AB测试时，需要控制变量，只调整算法，或者页面已达到测试结果明确知道是由哪个变量改变引起的。所以可能需要一个流量分配系统：用户进来的时候流量分配系统决定用户参与AB测试的哪一个，然后记录用户的行为日志，最后进入评测系统评测结果。

>> 一般来说，一个新的推算法统最终上线，需要完成上面所说的三个实验，首先：需要通过离线实验证明它在很多离线指标上优于现有的算法；然后，需要通过用户调查确定它的用户满意度不低于现有的算法；最后，通过在线AB测试确定它在我们关心的指标上优于现有的算法。

####评测指标
1. 用户满意度:用户满意度主要通过对一些用户行为的统计得到，比如电商中用户购买了推荐的商品，就表示他们在一定程度上的满意。因此可以通过高买率来度量用户满意度，此外，有些网站会通过设计一些用户反馈界面手机用户满意度（在给用户推荐产品后，例如问题：对推荐结果满意与否；推荐结果是否感兴趣）；更一般的情况下可以将点击率、用户停留时间和转化率等指标度量用户的满意度。
2. 预测准确度:预测准确度度量一个推荐系统或者推荐算法预测用户行为的能力，这个指标是最重要的推荐系统离线评测指标，这个指标可以通过离线实验计算（所以讨论较多，涉及论文较多）；在计算该指标时需要一个离线数据集，该数据集包含用户的历史行为记录。离线的推荐不同推荐方法这个也有不同的评测方法：评分预测(根据用户历史评分记录预测评分，对这种的评价就是对实际评分和系统预测分进行方差计算)；TopN推荐（给用一个个性化推荐列表，一般使用准确率和召回率来度量）。离散推荐算法的不同研究方向：评分预测、TopN推荐
3. 覆盖率：描述一个推荐系统对物品长尾的发掘能力（最简单的计算方法就是推荐出来的物品/物品总数，细致的可以统计不同物品出现次数分布，使用信息熵或者基尼系数来表示——评测推荐系统是否有马太效应（热的更热，冷的更冷），就使用基尼系数）
4. 多样性：用户可能兴趣很广，要能够覆盖用户的不同兴趣。（可以通过计算推荐物品中的不相似性来评测，推荐系统的整体多样性可以定义为所有用户推荐列表多样性的平均值）
5. 新颖性：指给用户推荐那些他们以前没有听过的物品。（通过剔除客户已经在系统中产生过的行为来提升新颖度，也可以降低推荐物品的流行度来提升，这方面还需要加强研究）
6. 惊喜度：用户可能并不知道喜欢这个，你却推荐出来，用户发现，哇塞我竟然喜欢这个
7. 信任度：只能通过问卷调查方式来评测
8. 实时性
9. 健壮性（避免作弊系统）
10. 商业目标（能否和盈利关联）

####评测维度
一个推荐系统可能整体表现不好，但是在某些方面表现比较好，增加评测维度的目的就是知道一个算法在什么情况下性能最好，这样而已融合不同推荐算法取得最好的整体性能带来参考。
* 用户维度 主要包括用户的人口统计学信息，活跃度以及是不是新用户等
* 物品维度 包括物品的属性信息、流行度、平均分以及是不是新加入物品
* 时间维度 包括季节、工作日还是周末，白天还是晚上

##利用用户行为数据
深入了解用户
###用户行为分析
长尾效应

是否可以看看用户投资收益和选股的一些分类是否也符合长尾（例如收益越高的客户选的越是具有投资价值的）
基于用户行为的数据设计的推荐算法一般称为协同过滤算法，协同过滤算法又分为：

1. 基于邻域的方法：基于用户协同过滤算法（给用户推荐和他兴趣相似的其他用户喜欢的物品）；基于物品的协同过滤算法（给用户推荐和他之前喜欢的物品相似的物品），一个是对多个用户的历史关联物品做矩阵处理；一个是对用户历史关联物品和其他物品做关联处理。（但是物品的相似是如何来的？本身分类）
2. 隐语义模型
3. 基于图的随机游走算法
####基于用户的协同过滤算法
1. 找到和目标用户兴趣相似的用户集合
2. 找到这个集合中的用户喜欢的，切目标用户没有听说过的物品推荐给目标用户
####基于物品的协同过滤算法
两步：
1. 计算物品之间的相似度
2. 根据物品相似度和用户的历史行为给用户生成推荐列表

基于用户的协同过滤更社会化，反应用户所在小型兴趣群体中物品的热门程度，而基于物品的推荐更加个性化，反应了用户自己的兴趣传承。——其实观察他们的计算，都是分析用户的行为，只不过一个是找用户的相似度一个是找物品的相似度，侧重不同但是根源一样。
按照这么理解，吃饭的推荐更像是基于用户推荐（或许两者都可以做测试，或者两者都采用）  

###隐语义模型
隐语义模型是最近几年推荐系统热门研究话题，核心思想是通过隐含特征联系用户兴趣和物品。
例如读书，可以先对书和物品的兴趣进行分类，对于某个用户，首先得到他的兴趣分类，然后从分类中挑选他可能喜欢的物品。
那问题是：
1. 如何对物品进行分类
2. 如何确定用户对哪些物品感兴趣，以及感兴趣程度
3. 对于一个给定的类，选择属于这个类的物品推荐给用户，以及如何确定这些物品在这个类中的权值

（如果这个方法可行，那聚类是否可以用到这里（或者分类也可以））
隐含语义分析技术因为采取基于用户行为统计的自动聚类，解决了人为分类的一些问题（权值无法确定，主观性，无法分多个类和多维度分类等）
这方面已经有以下模型：LSI、pLSA、LDA、Topic Model、隐含类别模型（LCM）、隐含主体模型（LTM）、矩阵分解（MF）。下面主要以LFM为例介绍隐含语义分析技术在推荐系统中的应用。
###基于图的模型
将用户行为数据二分图表示，用户和商品进行路径关联，然后通过路径去查找用户可能喜欢的物品（路径距离和出入度等的综合度量）

##推荐系统的冷启动问题
* 用户冷启动：新增用户，不知道这个用户的行为数据，无法根据其历史数据进行推测
* 物品冷启动：新增物品，新的物品推荐给可能感兴趣的用户，但是这个物品也没有过被操作历史
* 系统冷启动：一个新的网站，如何在开始的时候实施推荐系统

一般对上面的冷启动，有下面几种解决方案：
* 提供非个性化推荐：例如热门排行榜、随机（等到收集到一些数据的时候再开始进行个性化推荐）
* 利用注册信息提供年龄、性别等数据做粗粒度的个性化
* 利用用户社交账号登录，导入用户社交网络好友信息，然后推荐其好友喜欢的物品
* 要求用户登录时对一些物品进行反馈，收集用户对这些物品的兴趣信息，然后给用户推荐那些和这些物品相似的物品
* 对于新加入的物品，根据他们的内容信息将它们推荐给喜欢过和它们相似的物品的用户
* 在系统冷启动时，可以引入专家的知识，通过一定高效方式迅速建立物品的相关度表

###利用用户注册信息
用户注册信息分三种：
* 人口统计学信息：包括年龄、性别、职业、民族、学历和居住地
* 用户兴趣描述：让用户描述他们的兴趣
* 从其他网站导入用户站外行为数据

Bruce Krulwich的Lifestyle Finder将美国人口根据人口统计学属性分成62类（可以参考，也可以去取统计局数据来验证中国人口统计规律和分类方法）
基于用户注册推荐几本了流程：
1. 获取用户注册信息
2. 根据用户注册信息对用户进行分类（年龄地域之类）
3. 给用户推荐他所属于的分类中用户喜欢的物品（根据已有的客户，将物品按用户购买过的记录分类，然后和上面新用户分类比对，推荐物品，这里的分类就是指的用户的分类）

###选择合适的物品启动用户的兴趣
不立即推荐结果，而是给用户提供一些物品，让用户反馈他们对这些物品的兴趣，然后根据用户反馈提供个性化推荐。
通过让用户对物品进行评分收集用户兴趣，从而对用户进行分类，但是刚开始如何选择这些让用户评分的物品，这些物品必须满足一下几方面条件：
* 热门物品——如果要让用对物品反馈，前提是让用户知道这个东西是什么，例如冷门电影，用户都不知道如何反馈
* 具有代表性，如果物品都是老少皆宜，大家都喜欢，那反馈的意义就不是很大
* 启动物品集合需要多样性，由于不知道用户的兴趣，所以尽量多的类型可以最大可能的覆盖到用户感兴趣的地方（也可以让用户选分类——前提分好，例如：喜欢川菜、湘菜，辣的、甜的）

Nadav Golbandi专门对选择启动物品做了研究，可以参考下
###利用物品内容信息
这个主要针对的是物品冷启动——主要针对内容类，例如新闻等行业比较重要。餐饮也一样，新增菜品也可以根据菜品的一些属性先进行分类
通常物品的内容信息：

类别 | 内容
:---|:-----
图书|标题、作者、出版社、出版年代、丛书名、目录、正文
论文|标题、作者、作者单位、关键字、分类、摘要、正文
电影|标题、导演、演员、编剧、类型、剧情简介、发行公司
新闻|标题、正文、来源、作者
微博|作者、内容、评论

一般来说物品的内容可以通过向量空间模型（[Vector Space Mode](https://en.wikipedia.org/wiki/Vector_space_model)）表示，该模型将物品表示成一个关键词向量。（例如上面那些内容属性，有时候需要使用NLP来处理，使用TF-DF等来计算词的权重等）
还有一种，虽然文章使用的词语不同，但是这些词属于同一话题，这种需要知道文章的话题分布，然后才能计算文章的相似度，建立文章、话题和关键词的关系是话题模型（topic model——[LDA](http://www.jmlr.org/papers/volume3/blei03a/blei03a.pdf)）
[ECML/PKDD举行物品冷启动问题比赛](http://tunedit.org/challenge/VLNetChallenge)
###发挥专家的作用
例如[Pandora](http://www.pandora.com/about/mgp)雇佣一批懂计算机的音乐人进行一项音乐基因的项目，听几万首歌，并对这些歌的各个维度进行标注，使用了[400多个特征](http://en.wikipedia.org/wiki/List_of_Music_Genome_Project_attributes)。标注之后的歌曲，每首歌可以表示一个维度400的向量，然后通过向量来计算歌曲相似度。类似Pandora，[Jinni](http://www.jinni.com/movie-genome.html)对电影这么做，这样进行分类，就会细致很多，而不像只用作者这些粗粒度分类（一个作者可能就几首能听的歌而已）。
##利用用户标签数据
一般有三种方法进行推荐：
* 利用用户喜欢过的物品，推荐他喜欢的物品的相似的物品（item）
* 利用和用户兴趣相似的其他用户，推荐这些用户喜欢的产品（custom）
* 通过一些feature将物品和用户关联起来，给用户推荐那些具有用户喜欢的特征的物品‘

标签分两种：
一种是让专家和作者给用户打标签；一种是普通用户给物品打标签（UGC——User Generated Content）
标签作用：
* 表达：表达对物品的看法
* 组织：组织我喜欢的东西
* 学习：帮我们了解物品
* 发现：让我更容易发现我喜欢的物品
* 决策：帮我决定是否看某个物品

客户为什么打标签？打什么标签？如何打标签都是问题
####基于图的推荐算法
将客户、物品和标签都看成定点，而他们三者之间的联系看成边，然后采用类似PersonRank相似的算法来进行推荐。

####基于标签的推荐解释
类似豆瓣
###给用户推荐标签
为什么要给用户推荐标签？？
* 方便用户输入标签
* 提高标签质量（避免用户输入同义词，扩充了标签库而且使得描述不那么准确和规范）

##利用上下文信息
上面介绍的算法主要是将用户和物品关联在一起，而没有考虑到用户所处的上下文环境中——例如用户访问推荐系统的时间、地点和心情等。
（吃饭也要考虑上下文关系，例如季节、心情、是否生病和生理情况等）
`Author:Alexander Tuzhilin `

###时间上下文信息
将时间效应建模到推荐系统的模型中
####时间效应简介
* 用户兴趣变化：根据用户年龄或生活阶段（学生、工作前后等）变化，用户兴趣可能会存在较大的差异
* 物品也是有生命的：物品是否已经过时（时效性——也有可能不对，因为老歌曲、电影这种时效性比较差，这个得分类）
* 季节效应：例如夏天吃并欺凌、冬天吃火锅；夏天穿T恤

可以使用Google Insight来观察各个关键字的搜索热度
数据集每天独立用户数增长情况；系统物品变化情况；用户访问情况
####推荐系统的实时性
推荐系统需要平衡考虑用户的近期行为和长期行为
####推荐算法的时间多样性
推荐系统每天推荐结果的变化程度被定义为推荐系统的时间多样性，时间多样性高的推荐系统中用户常看到不同的推荐结果。
需要保证系统能够在用户有了新行为之后推荐结果有所反应，也能在没有新行为时经常变一下，保持时间多样性，一般有一下几种方法：
* 在推荐结果中加入一定的随机性：例如生成20个物品，随机选10个推荐给客户
* 记录用户每天都看到的推荐结果，然后第二天对这些物品降权
* 每天给客户使用不同的推荐算法

多样性必须建立在保证推荐精度的基础上。
####时间上下文推荐法
1. 最近最新热门：在热门列表物品计算时加上时间因素
2. 时间上下文相关的ItemCF算法：在计算物品相似度、用户行为时，增加时间权重，离得越近一般权重越大
3. 时间上下文相关的UserCFA算法：用户相似度、相似兴趣用户行为之间计算增加时间权重

###基于地点上下文信息
####基于位置的推荐算法
LARS：Location Aware Recommender System（位置感知推荐系统）
将物品分为两类：有空间属性的（餐馆之类）和无空间属性的（图书、电影等）；同时也将用户分为两类：有空间属性（比如用户现在的国家、城市邮编等）；另一类是没有相关属性的。
所以按照这些分类方式，数据集可以被组合分类成：

* 用户、用户位置、物品、评分：某一地点的用户对物品的评分
* 用户、物品、物品位置、评分：用户对某个地方的物品的评分
* 用户、用户位置、物品、物品位置、评分：某个位置的用户对某个位置的物品评分

**不同地方人对同一个地方的食物的评价不同（饮食差异，不同地方的食品在不同位置，相同的人也会有不同评价，因为人的手艺和橘生淮北则为枳的原因）**

* 兴趣本地化：不同地方的用户兴趣不同
* 活动本地化：一个用户往往在本地活动

##利用社交网络数据
###获取社交网络的数据途径
* 电子邮件
* 用户注册信息（同一个公司、学校等）
* 用户位置信息
* 论坛和讨论组
* 即时聊天工具
* 社交网络：Facebook都是自己认识的人——社交图谱；Twitter都是自己感兴趣的人——兴趣图谱（通讯录、微博、微信）

###社交网络数据的简介
一般有三种不同社交网络数据：
* 双向确认的社交网络数据：互相关注
* 单向关注的社交网络数据
* 基于社区的社交网络数据：用户之间没有明确的关系，但是同属于各种社区中。例如同属于一个豆瓣小组，说明兴趣相似，同一片论文作者肯定也存在着某些关系等

###基于社交网络的推荐
社会化推荐会：好友推荐会增加信任度；社交网络可以解决冷启动问题（但是其实好友的爱好不一定和自己想通）
####基于邻域的社会化推荐
给用户推荐好友喜欢的物品
####基于图的社会化推荐
#####信息流推荐
将好友做过的事情按照时间顺序列出来（或者通过其他的算法排序，例如FB的EdgeRank——包含会话长度、话题相关性和用户熟悉程度）
###给用户推荐好友
















想法：
可以通过结合基于内容和协同过滤两种方法，对每个人这两种方法都有一个权值来决定。

问题：
倒排表？

基于用户：相同用户的产品推荐（相同购买历史）；基于产品：购买了某个产品，而推荐和这个类似的产品
用户之间的相似度应该算一个研究点，这个直接影响推荐系统的有效性


机器学习中的相似性度量,通常计算样本间的距离：
1. 欧式距离:
2. 曼哈顿距离
3. 切比雪夫距离
4. 闵可夫斯基距离
5. 标准化欧氏距离
6. 马氏距离
7. 夹角余弦：用余弦表示两个向量方向上的差异
8. 汉明距离
9. 杰卡德距离&杰卡德相似度：杰卡德相似度=|A∩B|/|A∪B|;距离和相似度刚好相反，距离=1-相似度
10. 相关系数&相关距离
11.信息熵
















